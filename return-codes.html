<!DOCTYPE html>
<HTML>

<HEAD>

  <title>Lets talk about error handling... - Alexandr Poltavsky, software developer</title>

  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta http-equiv="Cache-Control" content="no-store" />

  <link rel="stylesheet" type="text/css" href="css/common.css" />
  <link rel="stylesheet" href="highlight/styles/hybrid.css">

</HEAD>

<BODY> 

<div id="wrap">

  <!-- header part -->

  <div id="header">

  <a href="/color-throne.html"><img class="ad" src="images/color-throne-logo-promo.png" title="Color Throne Game"/></a>    

  <a href="/">
      <img class="avatar" width="160" src="images/alexandr-poltavsky-avatar.jpeg" title="Alexandr Poltavsky" align="left"/>
    </a>
    <strong>
      Alexandr Poltavsky <br/> 
      Software developer <br/>
      <em>poltavsky.alexandr&#64;gmail.com</em> 
    </strong>
    <ul id="menu">
      <li><a href="/">Blog Contents</a></li>
      <li><a href="https://github.com/alexpolt/">Github</a></li>
      <li><a href="https://www.shadertoy.com/user/alexpolt">Shadertoy</a></li>
      <li><a href="https://twitter.com/poltavsky_alex">Twitter</a></li>
    </ul>

  </div>


  <div id="content" style="clear: left">

  <!-- here goes the main content -->

  <ul id="main-menu">
    <li id="main-menu-0"><a href="index.html">Programming</a></li>
    <li id="main-menu-1"><a href="index-gfx.html">Graphics</a></li>
    <li id="main-menu-2"><a href="index-off.html">Off-topic</a></li>
  </ul>


<h2>Lets talk about error handling...</h2>

<p>Lets consider a simple example of filling a std::vector:</p>

<pre><code>std::vector&lt;int&gt; data;

for( int i = 0; i &lt; 10; i++ ) data.push_back( i );
</code></pre>

<p>What could possibly go wrong? Well, apart from "out of memory"? Nothing. Computers are such
  marvellous machines that never fail (to execute some bug-free code like above). Except for
  hardware errors but that is out of a developer control. That puts the question what is an 
  error really and when do they happen.</p>

<p>If we think about it, we'll realize that the only sources of errors are external API calls.
  Okay, good. Anytime we call some API, be it a <em>syscall</em> or some <em>middleware</em> etc., there usually
  are some ways of communicating back the success state. And we have a choice what to do with it.</p>

<p>So this is what I'm trying to tell: every time we call an external API we have a choice of
  what to do with errors. If we state that some error (file not found, network timeout, etc.) is
  <strong>expected</strong> then we handle it right there in the code. Otherwise the error is <strong>unexpected</strong> 
  and we just don't do anything about it: we throw an exception.</p>

<p>Therefore I think there is little space for tools like <em>std::optional</em> or similar. Because it
  turns an obvious error into an implicit one. Just throw in that case, or handle it in place.</p>

<p>As for tools like <em>assert</em>, their primary purpose is to assist the type system but keep the code
  efficient. Take vector subscript as an example: should we be checking out of bounds access every
  time or just assert it? Asserting is the only valid option because we don't write buggy soft 
  (at least we do our best). And buggy soft is not something we should accept as a new normal.</p>

<p>Another important aspect is <strong>exception safety in C++</strong>. Again, if we rule out API calls and out 
  of memory then suddenly we have no point of failure. Then what's the value of creating that 
  insane layer of complexity? New jobs? A simple rule, that should've gone into C++ standard, 
  of not calling into OS or other APIs in object constructors (destructors are already special 
  cased) solves most exception safety issues.</p>

<p>Before I had written a post about <a href="exceptions.html">when to use exceptions</a>. It's still worth
  taking a look and becomes even more clear with above description.</p>


<script src="highlight/highlight.pack.js"></script>
<script>
  //hljs.configure({languages: ["C++"]});
  hljs.initHighlightingOnLoad();
</script>


<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */

    function run_disqus() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//alexpolt-github-io.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());

        (d.head || d.body).appendChild(s);

        d.getElementById("disqus_comments").innerHTML = ""; // alexpolt

        return undefined;
    };
</script>
<div id="disqus_comments"><a href="javascript: run_disqus()">read and write commentaries</a></div>
<div id="disqus_thread"></div>
<!--noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments
powered by Disqus.</a></noscript-->



  </div> <!-- end content -->

</div> <!-- end wrap -->



<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75341409-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter43425229 = new Ya.Metrika({
                    id:43425229,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/43425229" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

</BODY>

